---
title: R 統計分析筆記
draft: False
date: 2024-02-27
tags:
    - R
    - 統計分析
---
# 常態性檢定（Normality Test）
## Shapiro-Wilk 檢定
- **說明**：
	R 已有內建 Shapiro-Wilk 檢定函式 `shapiro.test()`。
- **範例**：
	```r
	shapiro.test(<待檢定數據>)
	```
- **成果驗證**：使用 R 與 SPSS 之結果相同，本結與 [Kolmogorov-Smirnov 檢定](#kolmogorov-smirnov-檢定)一併展示。

## Kolmogorov-Smirnov 檢定
- **說明**：
	R 已有內建 Kolmogorov-Smirnov 檢定函式 `ks.test()`。
- **範例**：
	```r
	ks.test(<待檢定數據>, "pnorm", mean=mean(<待檢定數據>), sd=sd(<待檢定數據>), alternative = c("two.sided"))
	# alternative 預設使用 "two.sided"，可視需求選用 "less" 或 "greater"。
	```
- **成果驗證**：
	使用 R 與 SPSS 之結果相同（p 值部分 R 預設功能不含 Lilliefors 校正，若必須使用可考慮使用 [nortest 套件之 `lillie.test()` 函式](https://search.r-project.org/CRAN/refmans/nortest/html/lillie.test.html)。另外，因本範例使用之樣本較少，故在 K-S 檢定時有警告信息）：
	<center><img style = "max-height: 500px;" src="20240227_R 統計分析筆記_1.avif"/></center>

# 同質性檢定（Homogeneity Test）
## Bartlett 檢定
- **說明**：
	R 已有內建 Bartlett 檢定函式 `bartlett.test()`。
- **範例**：
	```r
	bartlett.test(<待分析數據>~<待分析數據分組>, data = <數據來源>)
	# ex: bartlett.test(value~group, data = data)
	```
	或
	```r
	bartlett.test(<待分析數據>, <待分析數據分組>)
	# ex: bartlett.test(data$value, data$group)
	```
## Levene 檢定
- **說明**：
	R 通常通過 car 套件的 `leveneTest()` 函式進行 Levene 檢定。
- **範例**：
	```r
	library(car)
	leveneTest(<待分析數據>~<待分析數據分組>, data = <數據來源>, center = mean)
	leveneTest(<待分析數據>~<待分析數據分組>, data = <數據來源>, center = median)
	# ex: leveneTest(value~group, data = data, center = median)
	```
	或
	```r
	library(car)
	leveneTest(y = <待分析數據>, group = <待分析數據分組>, center = mean)
	leveneTest(y = <待分析數據>, group = <待分析數據分組>, center = median)
	# ex: leveneTest(y = data$value, group = data$group, center = median)
	```
- **參考資料**：
	- [car/leveneTest() 函式介紹](https://search.r-project.org/CRAN/refmans/car/html/leveneTest.html)
- **成果驗證**：
	使用 R 與 SPSS 之結果相同：  
	<center><img style = "max-height: 500px;" src="20240227_R 統計分析筆記_2.avif"/></center>

# 變異數分析
>　注意：進行變異數分析之前，務必先進行常態性檢定（Normality Test）以及變異數同質性檢定（Homogeneity Test for Variance），以確保符合統計分析方法之假設條件。
## 單因子變異數分析及其事後檢定
- **說明**：
	R 已有內建變異數分析函式 `aov()`，而事後檢定部分需透過其他套件實現，本範例使用 DescTools 套件進行單因子變異數分析之事後檢定。
- **範例**：
	```r
	library("DescTools") # 導入事後分析使用之 DescTools 函式庫。
	data <- read.csv("<待分析檔案位址>", header=TRUE) # 載入待分析檔案。
	AnovaTest <- aov(<待分析目標值>~<待分析組別>, data = data) # 透過單因子方差分析了解檔案中<待分析目標值>是否與<待分析組別>有關聯。
	# ex: AnovaTest <- aov(value~group, data = data)
	summary(AnovaTest) # 檢視分析結果。
	PostHocTest(AnovaTest, method="scheffe") # 使用 scheffe 法進行事後檢定（方法 "hsd"、"bonf"、"lsd"、"scheffe"、"newmankeuls" 擇一）。
	```
- **參考資料**：
	- [DescTools/PostHocTest() 函式介紹](https://search.r-project.org/CRAN/refmans/DescTools/html/PostHocTest.html)
- **成果驗證**：
	使用 R 與 SPSS 之結果相同（以 scheffe 事後檢定為例）：  
	<center><img style = "max-height: 500px;" src="20240227_R 統計分析筆記_3.avif"/></center>

